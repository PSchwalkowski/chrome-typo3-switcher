<!DOCTYPE html>
<html>
<head>
    <title>TYPO3 - Backend-Frontend Handy Switcher</title>
    <style>
        *   {
            box-sizing: border-box;
        }
        body {
            padding: 10px;
            width: 990px;
        }
        h2  {
            margin: .1em 0 .7em;
        }
        h3  {
            margin: 1em 0 .7em;
        }
        h4  {
            margin: 10px 0;
        }
        .settings-block  {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid lightgray;
        }
        /* default inputs & labels */
        label   {
            margin-right: 15px;
            margin-bottom: 8px;
        }
        label span  {
            display: inline-block;
        }
        label.check,
        label.radio,
        label.radio-item {
            cursor: pointer;
        }
        input[type="checkbox"]    {
            margin-right: 8px;
            cursor: pointer;
            vertical-align: top;
            margin-top: 2px;
        }
        input[type="radio"]    {
            margin-right: 8px;
            cursor: pointer;
            vertical-align: top;
        }
        input[type="text"]    {
            width: 260px;
            min-height: 2em;
            background-color: transparent;
            border-color: transparent;
            transition: background-color 0.3s;
            font-size: 1.2em;
        }
        input[type="text"]:focus,
        input[type="text"]:hover    {
            background-color: #fff;
            border-color: #bfbfbf;
        }
        input[type="text"].required:placeholder-shown {
            border-bottom-color: #ff8700;
        }
        input[name="context[name]"],
        input[name="link[name]"] {
            width: 150px;
        }
        input[name="context[url]"]  {
            width: 300px;
        }
        input[name="link[url]"] {
            width: 500px;
        }
        input[type="color"] {
            vertical-align: top;    /* middle doesn't work well here */
            margin-top: 2px;
            height: 1.9em;
            margin-left: 8px;
            cursor: pointer;
        }
        input.color-text    {
            width: 64px;
            margin-left: 8px;
        }

        label.hide  {
            position: absolute;
            padding: 3px 0 0 0 !important;
            top: 13px;
            right: 60px;
            cursor: pointer;
        }
        label.text input    {
            border: 1px solid #bbb;
        }
        label.text span    {
            margin-right: 8px;
        }
        input#env_badge_scale   {
            width: 35px;
        }

        /* buttons */
        button  {
            /*margin-bottom: 8px !important;*/
            cursor: pointer;
            /*border: none !important;*/
        }
        .btn {
            display: inline-block;
            margin-bottom: 0;
            font-weight: normal;
            text-align: center;
            vertical-align: middle;
            background-image: none !important;
            background-color: #dedede;
            border: 1px solid #c4c4c4;
            white-space: nowrap;
            padding: 6px 6px;
            line-height: 0.9;
            border-radius: 2px;
            user-select: none;
            box-shadow: none !Important;
            min-width: 28px;
            min-height: 28px;
            transition: background-color .1s, border-color .1s;
        }
            .btn:hover {
                color: #333333;
                background-color: #c4c4c4;
                border-color: #a6a6a6;
            }
            .btn .icon  {
                width: 16px;    height: 16px;
                display: inline-block;
                background: transparent no-repeat 0 0;
            }
            .btn .text {
                display: inline-block;
                line-height: 1.35em;
                vertical-align: top;
            }

        button.remove   {
            position: absolute;
            top: 10px;  right: 10px;
            /*background-size: 60% 60%;*/
        }
        button.remove .icon  {  background-image: url(/Icons/Options/Delete.svg);   }
        button.add .icon  {     background-image: url(/Icons/Options/Add.svg);  }
        button.save .icon  {    background-image: url(/Icons/Options/Save.svg);  }
        button.import .icon  {  background-image: url(/Icons/Options/Import.svg);  }
        button.export .icon  {  background-image: url(/Icons/Options/Export.svg);  }

        button.env_contextAddDefaultSet {
            display: none;
        }

        .projectItem    {
            position: relative;
            border: 1px solid transparent;
            background: #eee;
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 10px;
            transition: opacity 0.4s;
        }
        .projectItem:hover,
        .projectItem:focus    {
            border: 1px solid lightgray;
        }
        .projectItem > label  {
            display: block;
        }
        .contextItem, .linkItem    {
            position: relative;
            border: 1px solid lightgray;
            background: #ddd;
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 10px;
            transition: opacity 0.4s;
        }
        ._template  {
            display: none;
        }
        .toggle {
            position: absolute;
            top: 0;
            right: 150px;
            width: 530px;   height: 49px;
            cursor: pointer;
            /*background: red;*/
        }
            .toggle .icon   {
                display: block;
                width: 16px;    height: 16px;
                position: absolute;
                top: 17px;
                right: 10px;
                background: transparent url(Icons/Options/Expand.svg) no-repeat 0 0;
                opacity: 0;
                transition: opacity 0.4s;
            }
            .projectItem:hover > .toggle .icon    {
                opacity: 0.2;
            }
            .projectItem.collapse > .toggle .icon    {
                background: transparent url(Icons/Options/Collapse.svg) no-repeat 0 0;
            }
        .contextItem .toggle {
            width: 100px;
            /*background: green;*/
        }
            .contextItem:hover > .toggle .icon    {
                opacity: 0.2;
            }
            .contextItem.collapse > .toggle .icon    {
                background: transparent url(Icons/Options/Collapse.svg) no-repeat 0 0;
            }

        .projectItem.collapse .contexts,
        .projectItem.collapse .links,
        .contextItem.collapse .moreSettings    {
            display: none;
        }

        .projectItem.hidden,
        .contextItem.hidden,
        .linkItem.hidden    {
            opacity: .5;
        }

        .settings-block > label {
            display: block;
        }
        .settings-block > label:hover {
            background: #f8f8f8;
        }

        .status-save, .status-import {
            color: #ff8700;
            display: inline-block;
            vertical-align: middle;
            padding-left: 10px;
        }

        .dialog-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%;    height: 100%;
            background: #fff;
            opacity: 0.7;
        }
        .dialog {
            position: fixed;
            top: 0; left: 0;
            width: 100%;    height: 100%;
            text-align: center;
        }
        .dialog-inner {
            margin: 10% auto;
            background: #eee;
            padding: 15px;
            width: 50%;
        }
        .dialog button  {
            margin: 2px 5px;
        }

        .ui-sortable    {
            cursor: move;
        }
        .ui-sortable-helper {
        }
        .ui-state-highlight {
            min-height: 51px;
            padding: 10px;
            margin-bottom: 10px;
            background: #eaf5e0;
            border: 1px dashed #ccc !important;
        }

    </style>
</head>

<body>

    <div class="settings-block saveblock">
        <button class="btn save"><span class="icon"></span> <span class="text">Save</span></button>
        <span class="status-save"></span>
        <br>
        <br>
    </div>

    <div class="settings-block general">

        <h1>Switching</h1>

        <h3>to Frontend:</h3>
        <label class="check">
            <input type="checkbox" id="switch_fe_openSelectedPageUid">
            <span>Open current pagetree selected page uid <br>
                (disabled = open homepage)</span>
        </label>

        <h3>to Backend:</h3>
        <label class="check">
            <input type="checkbox" id="switch_be_useBaseHref">
            <span>Use &lt;base href&gt; to recognize backend url <br>
                (disabled = use current domain)</span>
        </label>

    </div>


    <div class="settings-block environments">

        <h1>Environment</h1>

        <label class="check">
            <input type="checkbox" id="env_enable">
            <span>Use this whole Contexts / Environments functionality <br>
                (disabled = no env menu, no badges, no nothing. only FE/BE switching)</span>
        </label>

        <h3>Context switch:</h3>

        <label class="check">
            <input type="checkbox" id="env_switching">
            <span>Enable right-click menu context switching</span>
        </label>

        <h3>Badge:</h3>

        <label class="check">
            <input type="checkbox" id="env_badge">
            <span>Display badge on page to identify current context</span>
        </label>
        <label class="check">
            <input type="checkbox" id="env_badge_projectname">
            <span>Show also project name on badge <br>
                (disabled = show only context name)</span>
        </label>
        <label class="radio">
            <span>Position:</span>
        </label>
        <label class="radio-item">
            <input type="radio" class="env_badge_position" id="env_badge_position_left" value="left" name="badge_position">
            On left corner</label>
        <label class="radio-item">
            <input type="radio" class="env_badge_position" id="env_badge_position_right" value="right" name="badge_position">
            On right corner</label>

        <label class="text">
            <span>Badge scale: </span>
            <input type="text" id="env_badge_scale">
            <span> (0.5 - 1.5 recommended, other may cause unexpected results)</span>
        </label>


        <br>

        <div class="projects">

            <h4>Projects</h4>

            <div class="projects-container"></div>
            <div class="projectItem collapse _template">

                <input type="text" name="project[name]" placeholder="Name" class="required">

                <div class="contexts">

                    <h4>Env contexts</h4>

                    <div class="contexts-container"></div>
                    <div class="contextItem collapse _template">

                        <label><input type="text" name="context[name]" placeholder="Name" class="required"></label>
                        <label><input type="text" name="context[url]" placeholder="Url" class="required"></label>
                        <label>Badge color:
                            <input type="color" class="color-picker">
                            <input type="text" name="context[color]" placeholder="#Hex" class="color-text" maxlength="7">
                        </label>

                        <!--<div class="moreSettings">
                            <label>
                                <input type="text" name="context[altBackendUrl]" placeholder="Alternative backend url">
                            </label>
                        </div>

                        <div class="toggle context"><span class="icon"></span></div>-->

                        <label class="check hide"><input type="checkbox" name="context[hidden]"> Disable </label>
                        <button class="btn remove env_contextRemove" title="Remove"><span class="icon"></span></button>
                    </div>

                    <button class="btn add env_contextAdd"><span class="icon"></span> <span class="text">Env context</span></button>
                    <button class="btn add env_contextAddDefaultSet" title="Adds some default predefined contexts"><span class="icon"></span> <span class="text">Add standard context set</span></button>
                </div>

                <div class="links">

                    <h4>Links</h4>

                    <div class="links-container"></div>
                    <div class="linkItem _template">

                        <label><input type="text" name="link[name]" placeholder="Name" class="required"></label>
                        <label><input type="text" name="link[url]" placeholder="Url" class="required"></label>

                        <label class="check hide"><input type="checkbox" name="link[hidden]"> Disable </label>
                        <button class="btn remove env_linkRemove" title="Remove"><span class="icon"></span></button>
                    </div>

                    <button class="btn add env_linkAdd"><span class="icon"></span> <span class="text">Link</span></button>
                </div>

                <div class="toggle project"><span class="icon"></span></div>

                <label class="check hide"><input type="checkbox" name="project[hidden]"> Disable </label>
                <button class="btn remove env_projectRemove" title="Remove"><span class="icon"></span></button>
            </div>

        </div>

        <button class="btn add env_projectAdd"><span class="icon"></span> <span class="text">Project</span></button>
        <br><br>
    </div>


    <div class="settings-block miscoptions">

        <h2>Misc options</h2>

        <label class="check">
            <input type="checkbox" id="ext_debug">
            <span>Debug info <br>
                (shows some console messages and vars values)</span>
        </label>
    </div>


    <div class="settings-block saveblock">
        <br>
        <button class="btn save"><span class="icon"></span> <span class="text">Save</span></button>
        <span class="status-save"></span>
        <br>
        <br>
    </div>


    <div class="settings-block importexport">

        <h2>Import / export</h2>
        <h4>Backup project settings or share with your team</h4>

        <label class="check">
            <input type="checkbox" id="env_import_overwrite">
            <span>Overwrite all current projects (!)<br>
                (disabled = add)</span>
        </label>
        <label class="check">
            <input type="checkbox" id="env_import_test">
            <span>Test import<br>
                (see the imported projects, you can tune them and save, or not.<br>
                disabled / default = autosave right after import)</span>
        </label>

        <p>Import projects from <abbr title="Treat import data structure as exported from selected extension (json or base64 json)">other extension</abbr>: &nbsp;

            <select id="env_import_extension">
                <option value=""></option>
                <option value="environment_switcher">Environment switcher</option>
                <option value="environment_switcher2">Environment switcher (other)</option>
                <option value="environment_marker">Environment marker</option>
            </select>
        </p>

        <br>
        <p>Import: paste JSON into textbox and press Import<br>
            Export: copy JSON from textbox</p>
        <textarea placeholder="paste json" id="env_importexport-data" cols="80" rows="5"></textarea>

        <br>
        <br>
        <button id="env_import" class="btn import"><span class="icon"></span> <span class="text">Import from textbox</span></button>

        <br>
        <br>
        <p>Or using file upload/download</p>
        <input type="file" id="env_import_file">
        <br>
        <br>
        <button id="env_export_download" class="btn export"><span class="icon"></span> <span class="text">Export - download</span></button>

        <span class="status-import"></span>
    </div>



    <div id="storageInfo"></div>
    <pre id="debug"></pre>

    <script src="Vendor/jquery-3.3.1.min.js"></script>
    <script src="Vendor/jquery-ui-1.12.1-custom.min.js"></script>
    <script src="options.js"></script>
</body>
</html>